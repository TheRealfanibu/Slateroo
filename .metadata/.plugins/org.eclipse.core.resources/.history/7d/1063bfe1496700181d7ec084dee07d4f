package ai;

import java.util.Random;
import java.util.function.UnaryOperator;

public class NeuralNetTest {
	public static void main(String[] args) {
		Matrix weights = new Matrix(2,1);
		weights.randomizeNormal(1);
		double bias = new Random().nextGaussian();
		double[][] x = {
				{0,0,1,1},
				{0,1,0,1}
		};
		double[] y = {0,1,1,0};
		Matrix X = Matrix.fromArray(x);
		Matrix Z = Matrix.multiply(weights.transpose(), X).addNumber(bias);
		UnaryOperator<Double> sigmoid = z -> 1 / (1 + Math.exp(-z));
		Matrix A = Z.applyToEveryElement(sigmoid);
		Matrix dZ = Matrix.subtract(A, Matrix.fromArray(y));
		Matrix dW = Matrix.multiply(X, dZ.transpose()).multiplyWithNumber(1 / 2d);
	}
}
